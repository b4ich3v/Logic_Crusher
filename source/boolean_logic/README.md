---

### **Обща концепция**

### **Клас: `BooleanFunction`**

Класът `BooleanFunction` инкапсулира булев израз, предоставяйки функционалности за парсиране, опростяване, оценка, анализ на свойства и минимизиране на израза.

### **Компоненти и Методи:**

1. **Инициализация `__init__`:**
    - **Вход:** Стринг, представляващ булевия израз.
    - **Процес:**
      - Инициализира се изразът и се парсира в AST чрез лексер и парсер.
      - Извличат и сортират се променливите, участващи в израза.
      - Инициализират се различни кешове за съхранение на изчислени свойства и резултати за повишаване на ефективността.
    - **Изход:** Инстанция на `BooleanFunction` с парсираното AST и идентифицираните променливи.

2. **Опростяване `simplify`:**
    - **Цел:** Опростява булевия израз чрез намаляване на неговата сложност.
    - **Процес:**
      - Проверява се дали опростената версия вече е кеширана.
      - Ако не е, опростява се AST и се премахват ненужните външни скоби.
      - Кешира се и връща опростеният израз като стринг.
    - **Изход:** Опростена версия на оригиналния булев израз.
  
3. **Премахване на Външни Скоби `remove_outer_parens`:**
    - **Цел:** Почиства стринга на израза чрез премахване на ненужни външни скоби.
    - **Процес:**
      - Изразът се отстраняват водещите и завършващи интервали.
      - Проверява се дали целият израз е затворен в един комплект скоби.
      - Уверява се, че тези скоби не са необходими за запазване на правилния ред на операциите.
      - Премахват се външните скоби, ако са излишни.
    - **Изход:** Стринг на израза без ненужни външни скоби.

4. **Преобразуване в Жегалкин Полином `to_zhegalkin`:**
    - **Цел:** Преобразува булевия израз в неговото представяне като Жегалкин полином.
    - **Процес:**
      - Използва AST за изчисляване на Жегалкин полинома въз основа на идентифицираните променливи.
      - Преобразува полинома в стринг формат, подходящ за показване или по-нататъшна обработка.
      - Кешира резултата за бъдеща употреба.
    - **Изход:** Стринг, представляващ Жегалкин полинома на булевата функция.

5. **Генериране на Истинна Таблица `get_truth_table`:**
    - **Цел:** Генерира пълната истинна таблица за булевата функция.
    - **Процес:**
      - Итерация през всички възможни комбинации от входни стойности въз основа на броя на променливите.
      - Оценява булевата функция за всяка комбинация.
      - Кешира истинната таблица за ефективно извличане при последващи извиквания.
    - **Изход:** Списък от кортежи, всеки съдържащ набор от входни стойности и съответния изход на булевата функция.                                                
6. **Оценка `evaluate`:**
    - **Цел:** Изчислява стойността на булевата функция за даден набор от присвоявания на променливите.
    - **Вход:** Дикт `env`, който съпоставя имената на променливите с техните булеви стойности.
    - **Процес:**
      - Използва AST за оценка на израза въз основа на предоставената среда.
    - **Изход:** Резултатът от оценката на булевата функция (0 или 1).
  
7. **Проверка на Свойства:**
    - **Запазване на Нула `preserves_zero`:**
        - **Цел:** Определя дали булевата функция връща 0, когато всички входове са 0.
        - **Процес:** Оценява функцията с всички променливи зададени на 0 и проверява изхода.
    - **Запазване на Единица `preserves_one`:**
        - **Цел:** Определя дали булевата функция връща 1, когато всички входове са 1.
        - **Процес:** Оценява функцията с всички променливи зададени на 1 и проверява изхода.
    - **Самодуелност `is_self_dual`:**
        - **Цел:** Проверява дали функцията е самодуелна, което означава, че размяната на всички 0 с 1 в входа инвертира изхода.
        - **Процес:** Сравнява всеки изход с изхода на допълнената входна комбинация.
    - **Монотонност `is_monotonic`:**
        - **Цел:** Определя дали функцията е монотонна, т.е. увеличаваща се във всички променливи.
        - **Процес:** Уверява се, че променянето на всяка входна стойност от 0 на 1 не намалява изхода.
    - **Линейност `is_linear`:**
        - **Цел:** Проверява дали функцията е линейна, което означава, че може да се изрази като линейна комбинация на променливите без продукти.
        - **Процес:** Анализира Жегалкин полинома, за да се увери, че нито един моном съдържа повече от една променлива.
    - **Кеширане:**
        - Всяка проверка на свойство кешира резултата си, за да избегне излишни изчисления при бъдещи извиквания.

8. **Минимизиране `minimize`:**
    - **Цел:**: Опростява булевата функция до минимална форма, използвайки алгоритъма на Куин-МакКласки.
    - **Процес:**
      - Генерира истинната таблица и идентифицира всички минтермини, където функцията връща 1.
      - Прилага алгоритъма на Куин-МакКласки за намиране на най-простата сума на продукти.
      - Форматира минимизирания израз и премахва ненужните скоби.
      - Кешира минимизирания израз за бъдеща употреба.
    - **Изход:** Минимизирана версия на булевия израз, оптимизирана за простота.
  
9. **Кофактор `cofactor`:**
    - **Цел:** Изчислява кофактора на булевата функция спрямо конкретна променлива, зададена на дадена стойност.
    - **Вход:**
        - `variable`: Променливата, която ще бъде зададена.
        - `value`: Стойността (0 или 1), която ще се присвои на променливата.
    - **Процес:**
      - Замества зададената променлива с дадената стойност в AST.
      - Опростява полученото изразяване.
      - Връща нова инстанция на `BooleanFunction`, представляваща кофактора.
    - **Изход:** Нова инстанция на `BooleanFunction`, представляваща кофактора с променливата зададена на дадената стойност.
  
 10. **Декомпозиция `decompose`:**
    - **Цел:** Декомпозира булевата функция в два кофактора въз основа на конкретна променлива.
    - **Вход:**
        - `variable`: Променливата, спрямо която ще се декомпозира функцията.
    - **Процес:**
      - Изчислява кофактора, където променливата е зададена на 0.
      - Изчислява кофактора, където променливата е зададена на 1.
      - Връща двата кофактора.
    - **Изход:** Кортеж, съдържащ две инстанции на `BooleanFunction`, представляващи функцията с променливата зададена на 0 и 1 съответно.

11. **Равенство и Хеширане `__eq__` и `__hash__`:**
    - **Цел:** Дефинира как инстанциите на `BooleanFunction` се сравняват и съхраняват в колекции, базирани на хеш.
    - **Процес:**
      - Две инстанции на `BooleanFunction` се считат за равни, ако техните изрази са идентични.
      - Хешът на `BooleanFunction` се базира на хеша на стринга на израза.
    - **Изход:**
        - `__eq__`: Връща True, ако изразите съвпадат, иначе `False`.
        - `__hash__`: Връща цяло число, представляващо хеш стойността на израза.
     
### **Клас: `BooleanFunctionSet`**

Класът `BooleanFunctionSet` управлява колекция от уникални инстанции на `BooleanFunction`, предоставяйки функционалности за добавяне на нови функции и извличане на подробна информация за всички съхранени функции.

### **Компоненти и Методи:**          

1. **Инициализация `__init__`:**
    - **Процес:**
      - Инициализира се празен сет за съхранение на инстанции на `BooleanFunction`.
    - **Изход:** Инстанция на `BooleanFunctionSet`, готова да съдържа булеви функции.
  
2. **Добавяне на Функции `add_function`:**
    - **Цел:** Добавя нова инстанция на `BooleanFunction` към сета.
    - **Вход:** Инстанция на BooleanFunction (boolean_function).
    - **Процес:**
      - Вмъква функцията в сета, осигурявайки уникалност на базата на израза на функцията.
    - **Изход:** Функцията се съхранява в сета; няма връщана стойност.
  
3. **Извличане на Информация за Функции `get_functions_info`:**
    - **Цел:** Събира подробна информация за всяка инстанция на `BooleanFunction` в сета.
    - **Процес:**
      - Итерация през всички функции в сета.
      - За всяка функция се компилира речник, съдържащ:
          - **Израз:** Оригиналният булев израз.
          - **Опростен:** Опростената версия на израза.
          - **Жегалкин Полином:** Жегалкин представянето.
          - **Свойства:** Речник, описващ свойства като запазване на нула и единица, самодуелност, монотонност и линейност.
          - **Минимизирани Израз:** Минимизирана форма, използвайки Куин-МакКласки.
          - **Брой на Променливите:** Броят на различните променливи във функцията.
          - **Истинна Таблица:** Форматирана истинна таблица, показваща комбинациите от входове и съответните изходи.
       - Събира всички такива речници в списък.
    - **Изход:** Списък от речници, всеки представляващ подробна информация за една булева функция в сета.
  
4. **Форматиране на Истинни Таблици `_format_truth_table`:**
    - **Цел:** Преобразува суровите данни от истинната таблица в структурирани и четими формати.
    - **Вход:**
        - `truth_table`: Списък от кортежи, съдържащи входни стойности и изход.
        - `variables`: Списък от имена на променливите, съответстващи на входните стойности.
    - **Процес:**
      - Итерация през всяка записа в истинната таблица.
      - За всяка комбинация от входове се създава речник, съпоставящ всяка променлива със съответната ѝ стойност.
      - Асосират всяка входна комбинация с нейния изход.
      - Компилират се тези речници в списък от речници за лесна четимост и по-нататъшна обработка.
    - **Изход:** Списък от речници, всеки съдържащ `inputs` речник и `output` стойност, представляващи истинната таблица в структурирана форма.
